# API-Nest 项目结构说明

本文档描述了API-Nest项目的目录结构和文件组织方式，以便开发团队理解和遵循项目的架构设计。

## 目录结构

```
src/
├── common/              # 通用功能模块
│   ├── decorators/      # 自定义装饰器
│   ├── dto/             # 通用DTO对象
│   ├── filters/         # 异常过滤器
│   ├── interfaces/      # 接口定义
│   ├── middleware/      # 中间件
│   ├── pipes/           # 管道
│   └── utils/           # 工具函数
├── config/              # 配置相关
│   ├── configuration.ts # 配置加载
│   ├── validation.schema.ts # 配置验证Schema
│   └── index.ts         # 配置导出
├── modules/             # 业务模块
│   └── user/            # 用户模块（示例）
│       ├── dto/         # 数据传输对象
│       ├── entities/    # 实体定义
│       ├── user.controller.ts # 控制器
│       ├── user.service.ts    # 服务
│       └── user.module.ts     # 模块定义
├── app.controller.ts    # 主控制器
├── app.module.ts        # 主模块
├── app.service.ts       # 主服务
└── main.ts              # 入口文件
```

## 模块组织原则

1. **主模块**：`app.module.ts` 作为应用程序的根模块，负责导入所有其他模块。

2. **业务模块化**：所有的业务功能都放在 `modules` 目录下，每个业务功能都有自己的子目录。

3. **通用功能**：所有可复用的通用功能（如过滤器、中间件等）都放在 `common` 目录下。

4. **配置集中管理**：所有的配置都通过 `config` 目录下的文件进行管理。

## 模块结构

每个业务模块通常包含以下文件：

- `*.module.ts`：模块定义，负责导入和导出该模块的组件
- `*.controller.ts`：控制器，处理HTTP请求
- `*.service.ts`：服务，实现业务逻辑
- `dto/`：数据传输对象，用于验证请求和响应数据
- `entities/`：实体定义，映射数据模型

## 开发规范

1. **命名规范**：

   - 文件名使用短横线分隔（kebab-case）
   - 类名使用大驼峰命名法（PascalCase）
   - 方法和变量使用小驼峰命名法（camelCase）

2. **模块依赖**：模块之间的依赖应该通过模块导入来显式声明，避免直接引用其他模块中的具体实现类。

3. **异常处理**：统一使用NestJS的异常机制，通过异常过滤器进行统一处理。

4. **配置管理**：使用ConfigModule进行配置管理，避免硬编码配置信息。

5. **接口文档**：使用Swagger进行API文档生成，确保接口文档与代码保持同步。

## 依赖注入

NestJS使用依赖注入管理组件之间的依赖关系。在开发中，应遵循以下原则：

1. 通过构造函数注入依赖
2. 使用接口而非具体实现类型
3. 单一职责原则，每个服务只负责一个功能领域

## 扩展指南

要添加新的业务模块，可以参照以下步骤：

1. 在 `modules` 目录下创建新的模块目录
2. 创建模块定义、控制器、服务等文件
3. 在DTO目录下定义请求和响应的数据结构
4. 在实体目录下定义数据模型
5. 在主模块中导入新模块

要添加新的全局功能，如中间件、过滤器等，可以：

1. 在 `common` 目录下相应的子目录中创建新文件
2. 在主模块中注册该功能

## 注意事项

- 保持模块的独立性，避免循环依赖
- 适当使用懒加载模块以提高性能
- 关注异常处理和日志记录，确保系统的可维护性
- 测试覆盖率应当达到合理水平，特别是核心业务逻辑
